<!DOCTYPE html>
<html>
<head>
<style>
table, th, td {
  border: 1px solid black;
}
</style>
</head>
<body>
<table>
  <thead>
    <tr>
      <th scope="col" rowspan="2">Geography</th>
      <th scope="col" rowspan="2">Country</th>
      <th scope="col" rowspan="2">Iou</th>
      <th colspan="2" >Date1</th>
      <th colspan="2" scope="colgroup">Date2</th>
      <th colspan="2" scope="colgroup">Date3</th>
      <th scope="col" rowspan="2">Total</th>
    </tr>
    <tr>
    <th scope="col">Male</th>
    <th scope="col">Female</th>
    <th scope="col">Male</th>
    <th scope="col">Female</th>
    <th scope="col">Male</th>
    <th scope="col">Female</th>
  </tr>
  </thead>
  <tbody>
    <tr>
	  <td>geography1</td>
	  <td>India</td>
	  <td>iou1</td>
	  <td>20</td>
	  <td>20</td>
	  <td>20</td>
	  <td>20</td>
	  <td>20</td>
	  <td>20</td>
	  <td>120</td>
  </tr>
  <tr>
	  <td>geography1</td>
	  <td>India</td>
	  <td>iou2</td>
	  <td>30</td>
	  <td>30</td>
	  <td>30</td>
	  <td>30</td>
	  <td>30</td>
	  <td>30</td>
	  <td>180</td>
  </tr>
  <tr>
	  <td>geography1</td>
	  <td>Srilanka</td>
	  <td>iou1</td>
	  <td>20</td>
	  <td>20</td>
	  <td>20</td>
	  <td>20</td>
	  <td>20</td>
	  <td>20</td>
	  <td>120</td>
  </tr>
  <tr>
	  <td>geography1</td>
	  <td>Srilanka</td>
	  <td>iou2</td>
	  <td>30</td>
	  <td>30</td>
	  <td>30</td>
	  <td>30</td>
	  <td>30</td>
	  <td>30</td>
	  <td>180</td>
  </tr>
   <tr>
	  <td>geography2</td>
	  <td>England</td>
	  <td>iou1</td>
	  <td>40</td>
	  <td>40</td>
	  <td>40</td>
	  <td>40</td>
	  <td>40</td>
	  <td>40</td>
	  <td>240</td>
  </tr>
   <tr>
	  <td>geography2</td>
	  <td>England</td>
	  <td>iou2</td>
	  <td>50</td>
	  <td>50</td>
	  <td>50</td>
	  <td>50</td>
	  <td>50</td>
	  <td>50</td>
	  <td>300</td>
  </tr>
   <tr>
	  <td>geography2</td>
	  <td>Italy</td>
	  <td>iou1</td>
	  <td>40</td>
	  <td>40</td>
	  <td>40</td>
	  <td>40</td>
	  <td>40</td>
	  <td>40</td>
	  <td>240</td>
  </tr>
   <tr>
	  <td>geography2</td>
	  <td>Italy</td>
	  <td>iou2</td>
	  <td>50</td>
	  <td>50</td>
	  <td>50</td>
	  <td>50</td>
	  <td>50</td>
	  <td>50</td>
	  <td>300</td>
  </tr>
   <tr>
	  <td>geography3</td>
	  <td>USA</td>
	  <td>iou1</td>
	  <td>60</td>
	  <td>60</td>
	  <td>60</td>
	  <td>60</td>
	  <td>60</td>
	  <td>60</td>
	  <td>360</td>
  </tr>
   <tr>
	  <td>geography3</td>
	  <td>USA</td>
	  <td>iou2</td>
	  <td>70</td>
	  <td>70</td>
	  <td>70</td>
	  <td>70</td>
	  <td>70</td>
	  <td>70</td>
	  <td>420</td>
  </tr>
  <tr>
	  <td>geography3</td>
	  <td>Canada</td>
	  <td>iou1</td>
	  <td>60</td>
	  <td>60</td>
	  <td>60</td>
	  <td>60</td>
	  <td>60</td>
	  <td>60</td>
	  <td>360</td>
  </tr>
   <tr>
	  <td>geography3</td>
	  <td>Canada</td>
	  <td>iou2</td>
	  <td>70</td>
	  <td>70</td>
	  <td>70</td>
	  <td>70</td>
	  <td>70</td>
	  <td>70</td>
	  <td>420</td>
  </tr>
   <tr>
	  <td>total</td>
	  <td></td>
	  <td></td>
	  <td>100</td>
	  <td>120</td>
	  <td>140</td>
	  <td>160</td>
	  <td>180</td>
	  <td>200</td>
	  <td></td>
  </tr>
  </tbody>
</table>
<script>
	/*
const table = document.querySelector('thead');

//---------------------//

var obj=[["geography",1,1000,1000,null],
		["country",1,1004,1004,null],
		["Iou",1,1005,1005,null],
		["Date1",1,1001,1001,2],
		["Date2",1,1001,1001,2],
		["Date3",1,1001,1001,2],
		["Male",2,1002,1001,null],
		["Female",2,1002,1001,null]];

console.log(obj.length);
var a=0;
for(var k=0;k<obj.length;k++)
{
	if(obj[k][1] > a)
	a=obj[k][1];
}	
console.log(a)
for(var l=a;l>0;l--)
{
	let tr = document.createElement('tr');
	for(var m=0;m<obj.length;m++)
	{
		console.log(a);
		for(var b=m+1;b<obj.length;b++)
		{
			if(b===obj.length)
			{
				break;
			}
			else
			{
				if((obj[m][2]===obj[b][3]) && (obj[m][1] === (obj[b][1]-1)))
				{
					var th = document.createElement('th');
					if(obj[b][4]!==null)
					{
						th.colSpan=obj[b][4];
						th.appendChild(document.createTextNode(obj[b][0]));
						tr.appendChild(th);
					}
					else
					{
						th.colSpan=obj[b][4];
						th.appendChild(document.createTextNode(obj[b][0]));
						tr.appendChild(th);
					}
				}
			}
		}
		
	}
	table.appendChild(tr);
}*/
/*if(obj[m][1]===l+1)
		{
			var th = document.createElement('th');
			if(obj[m][4]!==null)
			{
				th.colSpan=obj[m][4];
				th.appendChild(document.createTextNode(obj[m][0]));
				tr.appendChild(th);
			}
			else
			{
				th.rowSpan=a;
				th.appendChild(document.createTextNode(obj[m][0]));
				tr.appendChild(th);
			}*/
			
		
/*
var obj1=[[["geography",null],["Country",null],["Iou",null],["Date1",3],["date2",3],["date3",3],["Total",null]],[["Male",null],["Female",null],["Other",null]]];

console.log(obj1.length);
console.log(obj1[0].length)
console.log(obj1[1].length)

for(let k=0;k<obj1.length;k++)
{
	let tr = document.createElement('tr');
	for(let l=0;l<obj1[k].length;l++)
	{
		
		var th = document.createElement('th');
		if(obj1[k][l][1]!==null)
		{
		  th.colSpan=obj1[k][l][1];
		  th.appendChild(document.createTextNode(obj1[k][l][0]));
		  tr.appendChild(th);
	  }
	  else
	  {
		  var th = document.createElement('th');
		  th.rowSpan=obj1.length;
		  th.appendChild(document.createTextNode(obj1[k][l][0]));
		  tr.appendChild(th);
	  }
	  
	}
	table.appendChild(tr);
}*/
//--------------------//
/*for(let i=0;i<=1;i++)
  {
	  let tr = document.createElement('tr');
	  for(let j=0;j<7;j++)
	  {
		  if(j<=3)
		  {
		  var th = document.createElement('th');
		  th.rowSpan=2;
		  th.appendChild(document.createTextNode("Abc"));
		  tr.appendChild(th);
	  }
	  else
	  {
		  var th = document.createElement('th');
		  th.appendChild(document.createTextNode("Abc"));
		  tr.appendChild(th);
	  }
	  }
	  table.appendChild(tr);
  }*/

const table1 = document.querySelector('tbody');
let headerCell = null;
for(let i=2;i>=0;i--)
{
for (let row of table1.rows) {
	
	
		const firstCell = row.cells[i];
		
		if (headerCell === null || firstCell.innerText !== headerCell.innerText) {
    headerCell = firstCell;
}
else
{
	headerCell.rowSpan++;
    firstCell.remove();
}
	}
	headerCell = null
 
}
/*--------*/

			
  
  
  
</script>
</body>
</html>
